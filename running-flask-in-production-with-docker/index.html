<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>Running Flask in production with Docker</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css?v=e6220510ab" />

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="canonical" href="https://smirnov-am.github.io/running-flask-in-production-with-docker/" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <link rel="amphtml" href="https://smirnov-am.github.io/running-flask-in-production-with-docker/amp/" />
    
    <meta property="og:site_name" content="smirnov-am.github.io" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Running Flask in production with Docker" />
    <meta property="og:description" content="Google top for running Flask with Docker is full of posts where Flask runs in
debug mode.
That what logs look like when Flask is in development mode:

 * Serving Flask app &quot;app&quot; (lazy loading)
 * Environment: production
   WARNING: Do not use the development server in a production environment.
   Use a production WSGI server instead.
 * Debug mode: on
 * Running on http://0.0.0.0:5555/ (Press CTRL+C to quit)


I&#x27;d like to make a tutorial on how to run it with uwsgi in Docker using common
Docker " />
    <meta property="og:url" content="https://smirnov-am.github.io/running-flask-in-production-with-docker/" />
    <meta property="og:image" content="https://smirnov-am.github.io/content/images/2019/04/kitflask.jpg" />
    <meta property="article:published_time" content="2018-08-13T17:31:00.000Z" />
    <meta property="article:modified_time" content="2019-04-27T17:33:42.000Z" />
    <meta property="article:tag" content="Flask" />
    
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Running Flask in production with Docker" />
    <meta name="twitter:description" content="Google top for running Flask with Docker is full of posts where Flask runs in
debug mode.
That what logs look like when Flask is in development mode:

 * Serving Flask app &quot;app&quot; (lazy loading)
 * Environment: production
   WARNING: Do not use the development server in a production environment.
   Use a production WSGI server instead.
 * Debug mode: on
 * Running on http://0.0.0.0:5555/ (Press CTRL+C to quit)


I&#x27;d like to make a tutorial on how to run it with uwsgi in Docker using common
Docker " />
    <meta name="twitter:url" content="https://smirnov-am.github.io/running-flask-in-production-with-docker/" />
    <meta name="twitter:image" content="https://smirnov-am.github.io/content/images/2019/04/kitflask.jpg" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Alexey Smirnov" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Flask" />
    <meta property="og:image:width" content="600" />
    <meta property="og:image:height" content="485" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "smirnov-am.github.io",
        "logo": {
            "@type": "ImageObject",
            "url": "https://smirnov-am.github.io/favicon.ico",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Alexey Smirnov",
        "image": {
            "@type": "ImageObject",
            "url": "//www.gravatar.com/avatar/f3f61e69a3bdf7419f19cb1be356c0b1?s=250&d=mm&r=x",
            "width": 250,
            "height": 250
        },
        "url": "https://smirnov-am.github.io/author/alexey/",
        "sameAs": []
    },
    "headline": "Running Flask in production with Docker",
    "url": "https://smirnov-am.github.io/running-flask-in-production-with-docker/",
    "datePublished": "2018-08-13T17:31:00.000Z",
    "dateModified": "2019-04-27T17:33:42.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://smirnov-am.github.io/content/images/2019/04/kitflask.jpg",
        "width": 600,
        "height": 485
    },
    "keywords": "Flask",
    "description": "Google top for running Flask with Docker is full of posts where Flask runs in\ndebug mode.\nThat what logs look like when Flask is in development mode:\n\n * Serving Flask app &quot;app&quot; (lazy loading)\n * Environment: production\n   WARNING: Do not use the development server in a production environment.\n   Use a production WSGI server instead.\n * Debug mode: on\n * Running on http://0.0.0.0:5555/ (Press CTRL+C to quit)\n\n\nI&#x27;d like to make a tutorial on how to run it with uwsgi in Docker using common\nDocker ",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://smirnov-am.github.io/"
    }
}
    </script>

    <meta name="generator" content="Ghost 2.21" />
    <link rel="alternate" type="application/rss+xml" title="smirnov-am.github.io" href="https://smirnov-am.github.io/rss/" />
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-107429956-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-107429956-1');
</script>

</head>
<body class="post-template tag-flask">

    <div class="site-wrapper">

        

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
                <a class="site-nav-logo" href="https://smirnov-am.github.io">smirnov-am.github.io</a>
            <ul class="nav" role="menu">
    <li class="nav-home" role="menuitem"><a href="https://smirnov-am.github.io/">Home</a></li>
    <li class="nav-github" role="menuitem"><a href="https://github.com/smirnov-am">GitHub</a></li>
    <li class="nav-linkedin" role="menuitem"><a href="https://www.linkedin.com/in/smirnovam/">LinkedIn</a></li>
    <li class="nav-bookshelf" role="menuitem"><a href="https://smirnov-am.github.io/bookshelf/">Bookshelf</a></li>
</ul>

    </div>
    <div class="site-nav-right">
        <div class="social-links">
        </div>
            <a class="rss-button" href="https://feedly.com/i/subscription/feed/https://smirnov-am.github.io/rss/" title="RSS" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="6.18" cy="17.82" r="2.18"/><path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/></svg>
</a>
    </div>
</nav>
    </div>
</header>


<main id="site-main" class="site-main outer">
    <div class="inner">

        <article class="post-full post tag-flask ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime="2018-08-13">13 August 2018</time>
                        <span class="date-divider">/</span> <a href="/tag/flask/">Flask</a>
                </section>
                <h1 class="post-full-title">Running Flask in production with Docker</h1>
            </header>

            <figure class="post-full-image">
                <img
                    srcset="/content/images/size/w300/2019/04/kitflask.jpg 300w,
                            /content/images/size/w600/2019/04/kitflask.jpg 600w,
                            /content/images/size/w1000/2019/04/kitflask.jpg 1000w,
                            /content/images/size/w2000/2019/04/kitflask.jpg 2000w"
                    sizes="(max-width: 800px) 400px,
                            (max-width: 1170px) 700px,
                            1400px"
                    src="/content/images/size/w2000/2019/04/kitflask.jpg"
                    alt="Running Flask in production with Docker"
                />
            </figure>

            <section class="post-full-content">
                <div class="post-content">
                    <p>Google top for running Flask with Docker is full of posts where Flask runs in debug mode.<br>That what logs look like when Flask is in development mode:</p><!--kg-card-begin: code--><pre><code> * Serving Flask app "app" (lazy loading)
 * Environment: production
   WARNING: Do not use the development server in a production environment.
   Use a production WSGI server instead.
 * Debug mode: on
 * Running on http://0.0.0.0:5555/ (Press CTRL+C to quit)
</code></pre><!--kg-card-end: code--><p>I'd like to make a tutorial on how to run it with uwsgi in Docker using common Docker images.</p><h2 id="flask-app">Flask app</h2><p>I'll take a basic Flask app from it's official <a href="http://flask.pocoo.org/">docs</a></p><!--kg-card-begin: code--><pre><code>from flask import Flask
app = Flask(__name__)

@app.route("/")
def hello():
    return "Hello World!"
</code></pre><!--kg-card-end: code--><p>Naming this file as <code>hello.py</code> and running it with <code>FLASK_APP=test.py flask run --port 5555</code> will yield a warning that development server is used in a production environment like above.</p><h2 id="uwsgi">uwsgi</h2><p>As suggested by the warning we should use <code>uwsgi</code> to run it. For that to happen let's create a uwsgi configuration file named <code>uwsgi.ini</code></p><!--kg-card-begin: code--><pre><code>[uwsgi]
module = hello:app
uid = www-data
gid = www-data
master = true
processes = 5

socket = /tmp/uwsgi.socket
chmod-sock = 664
vacuum = true

die-on-term = true
</code></pre><!--kg-card-end: code--><p>So running uwsgi app with <code>uwsgi --ini uwsgi.ini</code> will give long output indicating that uwsgi started 5 processes (see <code>processes=5</code> in the config). Development server runs only 1 process thus allowing only 1 request at a time. By increasing this number you will increase the number if simultaneous requests to Flask app, but that will require more RAM and there will be more processes with Python interpreter running.</p><p>There is also a backlog for uwsgi meaning that if all workers (uwsgi processes) are busy with requests, excessive requests will be put in a queue of size 100 by default. Requests above that level will be dropped by uwsgi, but we will eventually have nginx in front of it with it's own backlog.</p><!--kg-card-begin: code--><pre><code>[uWSGI] getting INI configuration from uwsgi.ini                                             
*** Starting uWSGI 2.0.17.1 (64bit) on [Fri Aug  3 22:29:18 2018] ***                        
compiled with version: 7.2.0 on 03 August 2018 22:23:17                                      
os: Linux-4.13.0-46-generic #51-Ubuntu SMP Tue Jun 12 12:36:29 UTC 2018                      
nodename: ubuntuvm                                                                                                                                                                           
machine: x86_64                                                                              
clock source: unix                            
detected number of CPU cores: 4               
current working directory: /home/as/Desktop/blog                                    
detected binary path: /home/as/.virtualenvs/blog/bin/uwsgi                          
!!! no internal routing support, rebuild with pcre support !!!                               
your processes number limit is 63569          
your memory page size is 4096 bytes  
detected max file descriptor number: 1024     
lock engine: pthread robust mutexes                                                          
thunder lock: disabled (you can enable it with --thunder-lock)                               
uwsgi socket 0 bound to UNIX address /tmp/uwsgi.socket fd 3                                  
Python version: 3.6.3 (default, Oct  3 2017, 21:45:48)  [GCC 7.2.0]                          
*** Python threads support is disabled. You can enable it with --enable-threads ***          
Python main interpreter initialized at 0x562fb447cb40        i     i         i               
your server socket listen backlog is limited to 100 connections                              
your mercy for graceful operations on workers is 60 seconds                                  
mapped 437520 bytes (427 KB) for 5 cores                                                     
*** Operational MODE: preforking ***                                                         
WSGI app 0 (mountpoint='') ready in 1 seconds on interpreter 0x562fb447cb40 pid: 23917 (default app)                                                                                       
*** uWSGI is running in multiple interpreter mode ***                                        
spawned uWSGI master process (pid: 23917)     
spawned uWSGI worker 1 (pid: 23923, cores: 1) 
spawned uWSGI worker 2 (pid: 23924, cores: 1)                     
spawned uWSGI worker 3 (pid: 23925, cores: 1)                     
spawned uWSGI worker 4 (pid: 23926, cores: 1)                     
spawned uWSGI worker 5 (pid: 23927, cores: 1) 
</code></pre><!--kg-card-end: code--><p>Also this will create a socket file, that will be referred later in nginx configuration.</p><!--kg-card-begin: code--><pre><code>~ ls -la /tmp/uwsgi.socket  
srwxrwxr-x 1 as as 0 aug  3 22:29 /tmp/uwsgi.socket
</code></pre><!--kg-card-end: code--><p>Another thing is the user which runs <code>uwsgi</code> processes and owns a socket. Ideally you need to use user with minimum access right. With <code>uid</code>/<code>gid</code> options I've specified <code>www-data</code> - standard user used by web servers. If you run uwsgi manually from bash it will use your user for socket and processes. But in Docker we will run it as root so these options are needed to downgrade it to <code>www-data</code>.</p><p>Also I've seen that some distributions clean /tmp or some daemons have different view but it's not the case with the base distribution for the image I'm using.</p><p>Uwsgi has a lot of configuration options. There is a good list you need to check if you need to troubleshoot/tune your application that can be found <a href="https://uwsgi-docs.readthedocs.io/en/latest/ThingsToKnow.html">here</a></p><h2 id="nginx">nginx</h2><p>Nginx will serve as a proxy to uwsgi. It's nginx that will listen on ports 80/443 and forward requests to the socket.<br>It's config (named <code>nginx.conf</code>) is pretty straightforward (I'm omitting SSL config)</p><!--kg-card-begin: code--><pre><code>user www-data;
worker_processes auto;
pid /run/nginx.pid;

events {
    worker_connections 1024;
    use epoll;
    multi_accept on;
}

http {
    access_log /dev/stdout;
    error_log /dev/stdout;

    sendfile            on;
    tcp_nopush          on;
    tcp_nodelay         on;
    keepalive_timeout   65;
    types_hash_max_size 2048;

    include             /etc/nginx/mime.types;
    default_type        application/octet-stream;

    index   index.html index.htm;

    server {
        listen       80 default_server;
        listen       [::]:80 default_server;
        server_name  localhost;
        root         /var/www/html;

        location / {
            include uwsgi_params;
            uwsgi_pass unix:/tmp/uwsgi.socket;
        }
    }
}
</code></pre><!--kg-card-end: code--><p>I've added redirection of access and error logs to stdout so both will be accessible through <code>docker logs</code> command. Uwsgi logs are streamed to stdout by default.</p><p>One interesting thing I found is about long lasting requests. Nginx itself may kill these requests. So it's worth adding this config to <code>location</code> block:</p><!--kg-card-begin: code--><pre><code>uwsgi_read_timeout 1h;
uwsgi_send_timeout 1h;
proxy_send_timeout 1h;
proxy_read_timeout 1h;
</code></pre><!--kg-card-end: code--><h2 id="startup-script">Startup script</h2><p>This is a simple startup script that will be used as default for executing container.<br>Name of the file will be <code>start.sh</code> and it will be referred in Dockerfile.</p><!--kg-card-begin: code--><pre><code>#!/usr/bin/env bash
service nginx start
uwsgi --ini uwsgi.ini
</code></pre><!--kg-card-end: code--><h2 id="requirements">requirements</h2><p>Requirements file (<code>requirements.txt</code>) will have only flask and uwsgi and will look like this:</p><!--kg-card-begin: code--><pre><code>click==6.7
Flask==1.0.2
itsdangerous==0.24
Jinja2==2.10
MarkupSafe==1.0
uWSGI==2.0.17.1
Werkzeug==0.14.1
</code></pre><!--kg-card-end: code--><h2 id="dockerfile">Dockerfile</h2><p>I've tried a couple of ready-made images from Docker hub and found them overcomplicated or edited in a way by their maintainers making them unusable. So I'll start with basic python image.</p><!--kg-card-begin: code--><pre><code>FROM python:3.6-slim
</code></pre><!--kg-card-end: code--><p>First thing let's copy <code>hello.py</code>, <code>uwsgi.ini</code>, <code>requirements.txt</code> and <code>start.sh</code> to working directory:</p><!--kg-card-begin: code--><pre><code>COPY . /srv/flask_app
WORKDIR /srv/flask_app
</code></pre><!--kg-card-end: code--><p>Base image doesn't have nginx and some useful packages</p><!--kg-card-begin: code--><pre><code>RUN apt-get clean \
    &amp;&amp; apt-get -y update

RUN apt-get -y install nginx \
    &amp;&amp; apt-get -y install python3-dev \
    &amp;&amp; apt-get -y install build-essential
</code></pre><!--kg-card-end: code--><p>Now let's install python requirements</p><!--kg-card-begin: code--><pre><code>RUN pip install -r requirements.txt --src /usr/local/src
</code></pre><!--kg-card-end: code--><p>Finally, copy nginx config to the proper location, add execution rights to startup script and set is as default.</p><!--kg-card-begin: code--><pre><code>COPY nginx.conf /etc/nginx
RUN chmod +x ./start.sh
CMD ["./start.sh"]
</code></pre><!--kg-card-end: code--><h2 id="building-and-running">Building and running</h2><p>Image build can be done like so:</p><!--kg-card-begin: code--><pre><code>docker build . -t flask_image
</code></pre><!--kg-card-end: code--><p>It creates an image named <code>flask_image</code> that can be run with this command:</p><p><code>docker run --name flask_container -p 80:80 flask_image</code></p><p>Now you may navigate to <a href="http://localhost">http://localhost</a> in you browser to see the output.</p><p>Some useful options when running container</p><ul><li><code>--name</code> gives the container a name that can be found in <code>docker ps</code> output</li><li><code>-p</code> instructs to publish port 80. Second 80 after semicolons tells what port nginx inside the container listens on</li><li><code>-d</code> runs container detached from terminal. Logs then can be viewed by issuing <code>docker logs</code> command</li></ul><h2 id="advantages-of-dockerized-flask">Advantages of dockerized Flask</h2><p>I found it very useful to run Flask like that for a number of reasons:</p><p>Portability: spinning projects on a different machine with different distribution is a piece of cake, provided docker is installed.</p><p>No need to configure process managers (upstart/systemd)</p><p>Automatic restart of failed containers. Just use <code>--restart on-failure</code> with <code>docker run</code></p><p>It's very easy to start with almost serverless AWS ECS Fargate.</p><h2 id="troubleshooting">Troubleshooting</h2><p>When running docker container we specified port 80 so you host should have this port available for docker to bind to on you host. If it's not then change it to something else.</p><p>If your host runs multiple containers they should listen on different ports and some kind if proxy should be running on host OS to direct requests to the proper container.</p><p>To get inside the container issue <code>docker exec -it flask_container /bin/bash</code>. To get the exact container name issue <code>docker ps</code></p><p>To follow error and access logs issue <code>docker logs -f flask_container</code></p><p>How do you run Flask in production? Drop me a message on LinkedIn <a href="https://www.linkedin.com/in/smirnovam/">https://www.linkedin.com/in/smirnovam/</a></p>
                </div>
            </section>


            <footer class="post-full-footer">


                    
<section class="author-card">
        <img class="author-profile-image" src="//www.gravatar.com/avatar/f3f61e69a3bdf7419f19cb1be356c0b1?s&#x3D;250&amp;d&#x3D;mm&amp;r&#x3D;x" alt="Alexey Smirnov" />
    <section class="author-card-content">
        <h4 class="author-card-name"><a href="/author/alexey/">Alexey Smirnov</a></h4>
            <p>Read <a href="/author/alexey/">more posts</a> by this author.</p>
    </section>
</section>
<div class="post-full-footer-right">
    <a class="author-card-button" href="/author/alexey/">Read More</a>
</div>


            </footer>


        </article>

    </div>
</main>

<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
                <article class="read-next-card"

                >
                    <header class="read-next-card-header">
                        <small class="read-next-card-header-sitetitle">&mdash; smirnov-am.github.io &mdash;</small>
                        <h3 class="read-next-card-header-title"><a href="/tag/flask/">Flask</a></h3>
                    </header>
                    <div class="read-next-divider"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"/></svg>
</div>
                    <div class="read-next-card-content">
                        <ul>
                            <li><a href="/streaming-timeseries-with-flask-and-plotly/">Streaming timeseries with Flask and Plotly</a></li>
                            <li><a href="/background-jobs-with-flask/">Background jobs with Flask</a></li>
                            <li><a href="/multitenancy-with-flask/">Multitenancy with Flask</a></li>
                        </ul>
                    </div>
                    <footer class="read-next-card-footer">
                        <a href="/tag/flask/">See all 5 posts →</a>
                    </footer>
                </article>

                <article class="post-card post tag-flask ">

    <a class="post-card-image-link" href="/flask-pagination-macro/">
        <img class="post-card-image"
            srcset="/content/images/size/w300/2019/04/Pager-in-hand-684x513.jpg 300w,
                    /content/images/size/w600/2019/04/Pager-in-hand-684x513.jpg 600w,
                    /content/images/size/w1000/2019/04/Pager-in-hand-684x513.jpg 1000w,
                    /content/images/size/w2000/2019/04/Pager-in-hand-684x513.jpg 2000w"
            sizes="(max-width: 1000px) 400px, 700px"
            src="/content/images/size/w600/2019/04/Pager-in-hand-684x513.jpg"
            alt="Flask pagination macro"
        />
    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="/flask-pagination-macro/">

            <header class="post-card-header">
                    <span class="post-card-tags">Flask</span>
                <h2 class="post-card-title">Flask pagination macro</h2>
            </header>

            <section class="post-card-excerpt">
                <p>In this post I will cover how to create a pagination with Jinja macro feature.Requirements:show preconfigured limited number of pages at oncecollapse invisible pages under ...provide previous/next navigation buttonsJinja templates</p>
            </section>

        </a>

        <footer class="post-card-meta">

            <ul class="author-list">
                <li class="author-list-item">

                    <div class="author-name-tooltip">
                        Alexey Smirnov
                    </div>

                        <a href="/author/alexey/" class="static-avatar">
                            <img class="author-profile-image" src="//www.gravatar.com/avatar/f3f61e69a3bdf7419f19cb1be356c0b1?s&#x3D;250&amp;d&#x3D;mm&amp;r&#x3D;x" alt="Alexey Smirnov" />
                        </a>
                </li>
            </ul>

            <span class="reading-time">3 min read</span>

        </footer>

    </div>

</article>

                <article class="post-card post tag-python tag-flask tag-security ">

    <a class="post-card-image-link" href="/securing-flask-web-applications/">
        <img class="post-card-image"
            srcset="/content/images/size/w300/2019/04/flask11.jpg 300w,
                    /content/images/size/w600/2019/04/flask11.jpg 600w,
                    /content/images/size/w1000/2019/04/flask11.jpg 1000w,
                    /content/images/size/w2000/2019/04/flask11.jpg 2000w"
            sizes="(max-width: 1000px) 400px, 700px"
            src="/content/images/size/w600/2019/04/flask11.jpg"
            alt="Securing Flask web applications"
        />
    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="/securing-flask-web-applications/">

            <header class="post-card-header">
                    <span class="post-card-tags">python</span>
                <h2 class="post-card-title">Securing Flask web applications</h2>
            </header>

            <section class="post-card-excerpt">
                <p>I've just recently finished a web security training and in this post I'd like to investigate security mechanisms of my beloved web framework - Flask.I'll go through different types of possible vulnerabilities</p>
            </section>

        </a>

        <footer class="post-card-meta">

            <ul class="author-list">
                <li class="author-list-item">

                    <div class="author-name-tooltip">
                        Alexey Smirnov
                    </div>

                        <a href="/author/alexey/" class="static-avatar">
                            <img class="author-profile-image" src="//www.gravatar.com/avatar/f3f61e69a3bdf7419f19cb1be356c0b1?s&#x3D;250&amp;d&#x3D;mm&amp;r&#x3D;x" alt="Alexey Smirnov" />
                        </a>
                </li>
            </ul>

            <span class="reading-time">8 min read</span>

        </footer>

    </div>

</article>

        </div>
    </div>
</aside>

<div class="floating-header">
    <div class="floating-header-logo">
        <a href="https://smirnov-am.github.io">
            <span>smirnov-am.github.io</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">Running Flask in production with Docker</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-fb" href="https://www.linkedin.com/shareArticle?url=https://smirnov-am.github.io/running-flask-in-production-with-docker/&title=Running%20Flask%20in%20production%20with%20Docker" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"
width="26" height="26"
viewBox="0 0 192 192"
style=" fill:#000000;"><g fill="none" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><path d="M0,192v-192h192v192z" fill="none"></path><g fill="#ffffff"><g id="surface1"><path d="M156,0h-120c-19.875,0 -36,16.125 -36,36v120c0,19.875 16.125,36 36,36h120c19.875,0 36,-16.125 36,-36v-120c0,-19.875 -16.125,-36 -36,-36zM59.36539,162.98077h-29.82693l-0.17307,-89.30769h29.82692zM43.70192,61.99038h-0.17308c-9.75,0 -16.03846,-6.72115 -16.03846,-15.08653c0,-8.56731 6.49039,-15.0577 16.41347,-15.0577c9.92308,0 16.00961,6.49038 16.21153,15.0577c0,8.36538 -6.31731,15.08653 -16.41346,15.08653zM162.77885,162.98077h-30.08654v-48.51923c0,-11.74039 -3.11538,-19.73077 -13.61538,-19.73077c-8.01923,0 -12.34615,5.39423 -14.42308,10.61538c-0.77885,1.875 -0.98077,4.44231 -0.98077,7.06731v50.56731h-30.23077l-0.17308,-89.30769h30.23077l0.17308,12.60577c3.86538,-5.97116 10.29808,-14.42308 25.70192,-14.42308c19.09616,0 33.37501,12.46154 33.37501,39.25961v51.86539z"></path></g></g></g></svg>
</a>
        <a class="floating-header-share-tw" href="http://www.reddit.com/submit?url=https://smirnov-am.github.io/running-flask-in-production-with-docker/&title=Running%20Flask%20in%20production%20with%20Docker" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M14.238 15.348c.085.084.085.221 0 .306-.465.462-1.194.687-2.231.687l-.008-.002-.008.002c-1.036 0-1.766-.225-2.231-.688-.085-.084-.085-.221 0-.305.084-.084.222-.084.307 0 .379.377 1.008.561 1.924.561l.008.002.008-.002c.915 0 1.544-.184 1.924-.561.085-.084.223-.084.307 0zm-3.44-2.418c0-.507-.414-.919-.922-.919-.509 0-.923.412-.923.919 0 .506.414.918.923.918.508.001.922-.411.922-.918zm13.202-.93c0 6.627-5.373 12-12 12s-12-5.373-12-12 5.373-12 12-12 12 5.373 12 12zm-5-.129c0-.851-.695-1.543-1.55-1.543-.417 0-.795.167-1.074.435-1.056-.695-2.485-1.137-4.066-1.194l.865-2.724 2.343.549-.003.034c0 .696.569 1.262 1.268 1.262.699 0 1.267-.566 1.267-1.262s-.568-1.262-1.267-1.262c-.537 0-.994.335-1.179.804l-2.525-.592c-.11-.027-.223.037-.257.145l-.965 3.038c-1.656.02-3.155.466-4.258 1.181-.277-.255-.644-.415-1.05-.415-.854.001-1.549.693-1.549 1.544 0 .566.311 1.056.768 1.325-.03.164-.05.331-.05.5 0 2.281 2.805 4.137 6.253 4.137s6.253-1.856 6.253-4.137c0-.16-.017-.317-.044-.472.486-.261.82-.766.82-1.353zm-4.872.141c-.509 0-.922.412-.922.919 0 .506.414.918.922.918s.922-.412.922-.918c0-.507-.413-.919-.922-.919z"/></svg></a>
        <a class="floating-header-share-fb" href="https://news.ycombinator.com/submitlink?u=https://smirnov-am.github.io/running-flask-in-production-with-docker/&t=Running%20Flask%20in%20production%20with%20Docker" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"
width="100" height="100"
viewBox="0 0 50 50"
style=" fill:#000000;">    <path d="M 4 4 L 4 5 L 4 46 L 46 46 L 46 4 L 4 4 z M 6 6 L 44 6 L 44 44 L 6 44 L 6 6 z M 12.652344 13 L 14.238281 15.947266 L 21 28.503906 L 21 36 L 21 38 L 23 38 L 27 38 L 29 38 L 29 36 L 29 28.503906 L 35.761719 15.947266 L 37.347656 13 L 34 13 L 30.824219 13 L 29.664062 13 L 29.087891 14.007812 L 25 21.158203 L 20.912109 14.007812 L 20.337891 13 L 19.177734 13 L 16 13 L 12.652344 13 z M 16 15 L 19.175781 15 L 25 25.1875 L 30.824219 15 L 34 15 L 27 28 L 27 36 L 23 36 L 23 28 L 16 15 z"></path></svg></a>
    </div>
    <progress id="reading-progress" class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>




        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="https://smirnov-am.github.io">smirnov-am.github.io</a> &copy; 2019</section>
                <nav class="site-footer-nav">
                    <a href="https://smirnov-am.github.io">Latest Posts</a>
                    
                    
                    <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>


    <script>
        var images = document.querySelectorAll('.kg-gallery-image img');
        images.forEach(function (image) {
            var container = image.closest('.kg-gallery-image');
            var width = image.attributes.width.value;
            var height = image.attributes.height.value;
            var ratio = width / height;
            container.style.flex = ratio + ' 1 0%';
        })
    </script>


    <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="/assets/built/jquery.fitvids.js?v=e6220510ab"></script>


    <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('#reading-progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();

});
</script>


    

</body>
</html>
