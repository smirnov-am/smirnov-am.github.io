<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"  lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1"/>

<script type="application/ld+json">
    {
        "@context" : "http://schema.org",
        "@type" : "BlogPosting",
        "mainEntityOfPage": {
             "@type": "WebPage",
             "@id": "https:\/\/smirnov-am.github.io"
        },
        "articleSection" : "post",
        "name" : "Hello, World!",
        "headline" : "Hello, World!",
        "description" : "Other pytest articles:\nWhy testing is important\nTypes of tests\nTest driven Development\nHello, World!\nSelecting tests with pytest\nTesting HTTP client with pytest\nTesting database with pytest\nAdvanced fixtures with pytest\nPytest plugins\nIn this course, we will be working on a mobile phone number validation application.\nThe application: - Accepts a number as input - For every number in the list - Normalize the number - Check cache if this number was validated before - If it’s not in cache call external service REST API to validate the number - print the normalized number and the result of validation",
        "inLanguage" : "en-US",
        "author" : "",
        "creator" : "",
        "publisher": "",
        "accountablePerson" : "",
        "copyrightHolder" : "",
        "copyrightYear" : "2020",
        "datePublished": "2020-09-06 18:41:00 \x2b0000 UTC",
        "dateModified" : "2020-09-06 18:41:00 \x2b0000 UTC",
        "url" : "https:\/\/smirnov-am.github.io\/amp\/pytest-hello-world\/",
        "wordCount" : "744",
        "keywords" : [ "Python","pytest","Blog" ]
    }
    </script>

<title>Hello, World! | Alexey Smirnov</title>

<meta property='og:title' content='Hello, World! - Alexey Smirnov'>
<meta property='og:description' content='Other pytest articles:
Why testing is important
Types of tests
Test driven Development
Hello, World!
Selecting tests with pytest
Testing HTTP client with pytest
Testing database with pytest
Advanced fixtures with pytest
Pytest plugins
In this course, we will be working on a mobile phone number validation application.
The application: - Accepts a number as input - For every number in the list - Normalize the number - Check cache if this number was validated before - If it’s not in cache call external service REST API to validate the number - print the normalized number and the result of validation'>
<meta property='og:url' content='https://smirnov-am.github.io/amp/pytest-hello-world/'>
<meta property='og:site_name' content='Alexey Smirnov'>
<meta property='og:type' content='article'><meta property='og:image' content='https://www.gravatar.com/avatar/f3f61e69a3bdf7419f19cb1be356c0b1?s=256'><meta property='article:section' content='Post'><meta property='article:tag' content='Python'><meta property='article:tag' content='pytest'><meta property='article:published_time' content='2020-09-06T18:41:00Z'/><meta property='article:modified_time' content='2020-09-06T18:41:00Z'/><meta name='twitter:card' content='summary'><meta name='twitter:site' content='@'><meta name='twitter:creator' content='@'>


<link href="https://smirnov-am.github.io/index.xml" rel="alternate" type="application/rss+xml" title="Alexey Smirnov" />

<link rel="stylesheet" href="https://smirnov-am.github.io/css/style.css"/><link rel="apple-touch-icon" sizes="180x180" href="https://smirnov-am.github.io/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://smirnov-am.github.io/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://smirnov-am.github.io/favicon-16x16.png">
<link rel="manifest" href="https://smirnov-am.github.io/site.webmanifest">
<link rel="mask-icon" href="https://smirnov-am.github.io/safari-pinned-tab.svg" color="#5bbad5">
<link rel="canonical" href="https://smirnov-am.github.io/amp/pytest-hello-world/">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
<meta name="google-site-verification" content="LxHvTgaBdcBpIRtJMFKFiIvx5Mm45WC1z1S57O6O5O8" />
</head>
<body>
<section class="section">
  <div class="container">
    <nav id="nav-main" class="nav">
      <div id="nav-name" class="nav-left">
        <a id="nav-anchor" class="nav-item" href="https://smirnov-am.github.io">
          <h1 id="nav-heading" class="title is-4">Alexey Smirnov</h1>
        </a>
      </div>
      <div class="nav-right">
        <nav id="nav-items" class="nav-item level is-mobile"><a class="level-item" aria-label="github" href='https://github.com/smirnov-am'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
  
</svg></i>
            </span>
          </a><a class="level-item" aria-label="linkedin" href='https://linkedin.com/in/smirnovam'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path stroke-width="1.8" d="m5.839218,4.101561c0,1.211972 -0.974141,2.194011 -2.176459,2.194011s-2.176459,-0.982039 -2.176459,-2.194011c0,-1.211094 0.974141,-2.194011 2.176459,-2.194011s2.176459,0.982917 2.176459,2.194011zm0.017552,3.94922l-4.388022,0l0,14.04167l4.388022,0l0,-14.04167zm7.005038,0l-4.359939,0l0,14.04167l4.360816,0l0,-7.370999c0,-4.098413 5.291077,-4.433657 5.291077,0l0,7.370999l4.377491,0l0,-8.89101c0,-6.915523 -7.829986,-6.66365 -9.669445,-3.259423l0,-1.891237z"/>
  
</svg></i>
            </span>
          </a><a class="level-item" aria-label="youtube" href='https://youtube.com/channel/UC1PS5Vov2HSkz-fKCQUiffg'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"/>
  <polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"/>
  
</svg></i>
            </span>
          </a><a class="level-item" aria-label="email" href='mailto:msc.smirnov.am@gmail.com'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
  <polyline points="22,6 12,13 2,6"/>
  
</svg></i>
            </span>
          </a><a class="level-item" aria-label="rss" href='https://smirnov-am.github.io/index.xml'
            target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle>
  
</svg></i>
            </span>
          </a></nav>
      </div>
    </nav>

    <nav class="nav">
      
      <div class="nav-left"><a class="nav-item" href="https://smirnov-am.github.io/tags/aws">
          <h2 class="title is-5">AWS</h2>
        </a><a class="nav-item" href="https://smirnov-am.github.io/tags/flask">
          <h2 class="title is-5">Flask</h2>
        </a><a class="nav-item" href="https://smirnov-am.github.io/tags/python">
          <h2 class="title is-5">Python</h2>
        </a><a class="nav-item" href="https://smirnov-am.github.io/tags/vfx">
          <h2 class="title is-5">Computer vision for VFX</h2>
        </a></div>
      

      
    </nav>

  </div>
  <script src="https://smirnov-am.github.io/js/navicon-shift.js"></script>
</section>
<section class="section" style="padding: 0px 0px;">
    <div class="container has-text-centered" >
      <a href="https://easysaasboilerplate.com"><img src="https://smirnov-am.github.io/content/images/saas-ad.png"></a>
    </div>>
</section>
<section class="section">
  <div class="container">
    <div class="subtitle tags is-6 is-pulled-right">
      
      
<a class="subtitle is-6" href="https://smirnov-am.github.io/tags/python">#Python</a>



  
  | <a class="subtitle is-6" href="https://smirnov-am.github.io/tags/pytest">#pytest</a>
  

      
    </div>
    <h2 class="subtitle is-6">September 6, 2020</h2>
    <h1 class="title">Hello, World!</h1>
    
    <div class="content">
      <p>Other pytest articles:</p>

<p><a href="https://smirnov-am.github.io/pytest-why-testing">Why testing is important</a></p>

<p><a href="https://smirnov-am.github.io/pytest-test-types">Types of tests</a></p>

<p><a href="https://smirnov-am.github.io/pytest-tdd">Test driven Development</a></p>

<p><a href="https://smirnov-am.github.io/pytest-hello-world">Hello, World!</a></p>

<p><a href="https://smirnov-am.github.io/pytest-selecting_tests">Selecting tests with pytest</a></p>

<p><a href="https://smirnov-am.github.io/pytest-testing_http_client">Testing HTTP client with pytest</a></p>

<p><a href="https://smirnov-am.github.io/pytest-testing_database">Testing database with pytest</a></p>

<p><a href="https://smirnov-am.github.io/pytest-advanced-fixtures">Advanced fixtures with pytest</a></p>

<p><a href="https://smirnov-am.github.io/pytest-plugins">Pytest plugins</a></p>

<p>In this course, we will be working on a mobile phone number validation application.</p>

<p>The application:
- Accepts a number as input
- For every number in the list
  - Normalize the number
  - Check cache if this number was validated before
  - If it’s not in cache  call external service REST API to validate the number
  - print the normalized number and the result of validation</p>

<p>Let’s start with the Normalize step.
Numbers can contain hyphens, spaces, brackets and can start with a plus sign. Normalize function should leave plus sign and remove all others.</p>

<p>First we need to install pytest. Most obvious option is to use pip.</p>

<pre><code class="language-bash">pip install pytest
</code></pre>

<p>Let’s write first unit test cases describing these requirements. All of them will be inside <code>test_normalize.py</code> file.</p>

<p>First test case for spaces. Test case is just a function:</p>

<pre><code class="language-python">from normalize import normalize

def test_spaces():
    number = '555 12 34' # input number
    normalized_number = normalize(number) # our code we will write later
    assert normalized_number == '5551234' # expected result
</code></pre>

<p>As an input we have a number with spaces, and as an output we assume that the number won’t have them. Normalized number is a result of our normalized function. And we put an assertion at the end of the test that we get what we expect.</p>

<p>Basically assert is the main part of the test - we compare expected and actual results of some calculation and if they are not equal assert fail with an exception and pytest will show that test as failed. In more complex cases than that one it’s wise to have only one assertion in the end of the test case.</p>

<p>Next test case for hyphens:</p>

<pre><code class="language-python">def test_hyphens():
    number = '555-12-34'
    normalized_number = normalize(number)
    assert normalized_number == '5551234'
</code></pre>

<p>Then for brackets:</p>

<pre><code class="language-python">def test_brackets():
    number = '31(0)5551234'
    normalized_number = normalize(number)
    assert normalized_number == '3105551234'
</code></pre>

<p>Now let run the tests. Pytest will look for files starting with test in current directory and its subdirectories. It will find the functions starting with <code>test_</code> and recognize them as an individual test cases.</p>

<pre><code class="language-bash">~ pytest .

=== ERRORS ===
___ ERROR collecting test_normalize.py ___
ImportError while importing test module 'testing_python_with_pytest/test_normalize.py'.
Hint: make sure your test modules/packages have valid Python names.
Traceback:
test_normalize.py:3: in &lt;module&gt;
    from normalize import normalize
E   ModuleNotFoundError: No module named 'normalize'
=== short test summary info ===
ERROR test_normalize.py
!!! Interrupted: 1 error during collection !!!
=== 1 error in 0.24s ===
</code></pre>

<p>Now we are on a RED step of TDD - write a test that doesn’t work.</p>

<p>Let’s create dummy function  in <code>normalize.py</code></p>

<pre><code class="language-python">def normalize(number):
    return '1123455'
</code></pre>

<p>The output has changed - now we see that all tests failed (red Fs) and in the FAILURES section there is a description of every failure.</p>

<pre><code class="language-bash">test_normalize.py FFF                                                                                        [100%]

=== FAILURES ===
___ test_spaces  ___

    def test_spaces():
        number = '555 12 34'
        normalized_number = normalize(number)
&gt;       assert normalized_number == '5551234'
E       AssertionError: assert '1123455' == '5551234'
E         - 5551234
E         + 1123455
....
test_normalize.py:21: AssertionError
=== short test summary info ===
FAILED test_normalize.py::test_spaces - AssertionError: assert '1123455' == '5551234'
FAILED test_normalize.py::test_hyphens - AssertionError: assert '1123455' == '5551234'
FAILED test_normalize.py::test_brackets - AssertionError: assert '1123455' == '3105551234'
=== 3 failed in 0.17s ===
</code></pre>

<p>Now I&rsquo;m going to implement a normalize partially</p>

<pre><code class="language-python">import re

def normalize(number):
    return re.sub(r'[ \-()]', '', number)
</code></pre>

<p>Now all the tests are green</p>

<pre><code class="language-bash">pytest .
==== test session starts ===
collected 3 items

test_normalize.py ...                                                                                        [100%]

=== 3 passed in 0.04s ===
</code></pre>

<p>There seems to be some duplication - we have 3 cases that does the same. Pytest has a parametrization feature to combine them in one case to avoid duplication</p>

<pre><code class="language-python">import pytest

@pytest.mark.parametrize(&quot;test_input,expected&quot;, # 1
                         [('555 12 34', '5551234'), # 2
                          ('31(0)5551234', '3105551234'),
                          ('31(0)5551234', '3105551234')])
def test_normalize(test_input, expected): # 3
    assert expected == normalize(test_input)
</code></pre>

<ol>
<li>parametrize decorator accepts comma separated list of parameters - input number and expected normalized version as a first argument</li>
<li>second argument is a list of tuples, representing cases, in each tuple we have an input number and the expected result</li>
<li>test case function definition should contain 2 input arguments - same as we have in #1</li>
</ol>

<p>In this unit you&rsquo;ve learned how to launch pytest and create test cases. In the next unit we&rsquo;ll cover how to select test and test exceptions.</p>


      <section class="section">
  <p>Support the author - <a href="https://www.buymeacoffee.com/smirnovam">Buy me a coffee!</a></p>
</section>
    <script>talkyardServerUrl='https:\/\/comments-for-smirnov-am-github-io.talkyard.net';</script>
    <script async defer src="https://c1.ty-cdn.net/-/talkyard-comments.min.js"></script>
    
    <div class="talkyard-comments" data-discussion-id="pytest" style="margin-top: 45px;">
    <noscript>Please enable Javascript to view comments.</noscript>
    <p style="margin-top: 25px; opacity: 0.9; font-size: 96%">Comments powered by
    <a href="https://www.talkyard.io">Talkyard</a>.</p>
    </div>

      
      <div class="related">

<h3>Similar articles:</h3>
<ul>
	
	<li><a href="https://smirnov-am.github.io/amp/pytest-advanced-fixtures/">Advanced fixtures with pytest</a></li>
	
	<li><a href="https://smirnov-am.github.io/amp/pytest-plugins/">Pytest plugins</a></li>
	
	<li><a href="https://smirnov-am.github.io/amp/pytest-selecting_tests/">Selecting tests with pytest</a></li>
	
	<li><a href="https://smirnov-am.github.io/amp/pytest-tdd/">Test driven Development</a></li>
	
	<li><a href="https://smirnov-am.github.io/amp/pytest-testing_http_client/">Testing HTTP client with pytest</a></li>
	
</ul>
</div>
      
    </div>
    
  </div>
</section>

    <script src="https://smirnov-am.github.io/js/copycode.js"></script>



<section class="section">
  <div class="container has-text-centered">
    <p>&copy; Alexey Smirnov 2021</p>
    
  </div>
</section>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-107429956-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>




</body>
</html>

